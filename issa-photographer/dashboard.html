<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ø§Ù„Ù…ØµÙˆØ± Ø¹ÙŠØ³Ù‰</title>
    <style>
        /* Ø§Ù„Ø£Ù†Ù…Ø§Ø· ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0a0a0a;
            color: white;
            min-height: 100vh;
        }

        .login-screen {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
        }

        .login-form {
            background: #1a1a1a;
            padding: 3rem;
            border-radius: 20px;
            border: 2px solid #d4af37;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .login-form h2 {
            color: #d4af37;
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .login-form input {
            width: 100%;
            padding: 1rem;
            margin-bottom: 1rem;
            background: #2a2a2a;
            border: 1px solid #3a3a3a;
            border-radius: 10px;
            color: white;
            font-size: 1rem;
        }

        .login-btn {
            background: #d4af37;
            color: #0a0a0a;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            background: #b8941f;
        }

        .dashboard {
            display: none;
            padding: 2rem;
            max-width: 1600px;
            margin: 0 auto;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #d4af37;
        }

        .logout-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            text-decoration: none;
            display: inline-block;
        }

        .logout-btn:hover {
            background: #cc0000;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: #1a1a1a;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            border: 1px solid #2a2a2a;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            border-color: #d4af37;
            transform: translateY(-5px);
        }

        .stat-number {
            font-size: 2.5rem;
            color: #d4af37;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .filters {
            background: #1a1a1a;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: #2a2a2a;
            color: white;
            border: 1px solid #3a3a3a;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn.active {
            background: #d4af37;
            color: #0a0a0a;
            border-color: #d4af37;
        }

        .bookings-table {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 2rem;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1200px;
        }

        th, td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid #2a2a2a;
        }

        th {
            color: #d4af37;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .action-btn {
            background: #2a2a2a;
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin: 0 0.2rem;
            transition: all 0.3s ease;
        }

        .contacted-btn {
            background: #d4af37;
            color: #0a0a0a;
        }

        .serious-btn {
            background: #00aa00;
            color: white;
        }

        .not-serious-btn {
            background: #ff4444;
            color: white;
        }

        .delete-btn {
            background: #ff4444;
            color: white;
        }

        .status-pending { color: #ffa500; }
        .status-contacted { color: #00ff00; }
        .status-completed { color: #0088ff; }

        .export-btn {
            background: #d4af37;
            color: #0a0a0a;
            border: none;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 1rem;
            transition: all 0.3s ease;
        }

        .export-btn:hover {
            background: #b8941f;
        }

        .export-options {
            background: #1a1a1a;
            padding: 1rem;
            border-radius: 10px;
            margin-top: 1rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .export-option-btn {
            background: #2a2a2a;
            color: white;
            border: 1px solid #3a3a3a;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .export-option-btn:hover {
            background: #d4af37;
            color: #0a0a0a;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #d4af37;
            color: #0a0a0a;
            padding: 1rem 2rem;
            border-radius: 10px;
            font-weight: 700;
            z-index: 1000;
            display: none;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <div class="login-screen" id="loginScreen">
        <div class="login-form">
            <h2>Ø¯Ø®ÙˆÙ„ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>
            <input type="text" id="username" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
            <input type="password" id="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
            <button class="login-btn" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <div class="dashboard" id="dashboard">
        <div class="dashboard-header">
            <h1>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</h1>
            <a href="index.html" class="logout-btn">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="totalBookings">0</div>
                <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø­Ø¬ÙˆØ²Ø§Øª</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingBookings">0</div>
                <div>Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="contactedBookings">0</div>
                <div>ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="seriousClients">0</div>
                <div>Ø¹Ù…Ù„Ø§Ø¡ Ø¬Ø§Ø¯ÙŠÙ†</div>
            </div>
        </div>

        <div class="filters">
            <button class="filter-btn active" onclick="filterBookings('all')">Ø§Ù„ÙƒÙ„</button>
            <button class="filter-btn" onclick="filterBookings('pending')">Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</button>
            <button class="filter-btn" onclick="filterBookings('contacted')">ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„</button>
            <button class="filter-btn" onclick="filterBookings('serious')">Ø¬Ø§Ø¯ÙŠÙ†</button>
            <button class="filter-btn" onclick="filterBookings('notSerious')">ØºÙŠØ± Ø¬Ø§Ø¯ÙŠÙ†</button>
        </div>

        <div class="bookings-table">
            <table>
                <thead>
                    <tr>
                        <th>Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²</th>
                        <th>Ø§Ù„Ø§Ø³Ù…</th>
                        <th>Ø§Ù„Ù‡Ø§ØªÙ</th>
                        <th>Ø§Ù„Ø¨Ø±ÙŠØ¯</th>
                        <th>Ø§Ù„Ø®Ø¯Ù…Ø©</th>
                        <th>Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</th>
                        <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                        <th>Ø§Ù„Ù…Ø¯Ø©</th>
                        <th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th>
                        <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        <th>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</th>
                        <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
                        <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                    </tr>
                </thead>
                <tbody id="bookingsList">
                </tbody>
            </table>
        </div>

        <button class="export-btn" onclick="showExportOptions()">ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        
        <div class="export-options" id="exportOptions" style="display: none;">
            <button class="export-option-btn" onclick="exportData('csv')">CSV (Ù„Ù€ Excel)</button>
            <button class="export-option-btn" onclick="exportData('txt')">TXT (Ø£ÙƒØ«Ø± ØªÙˆØ§ÙÙ‚Ø§Ù‹)</button>
            <button class="export-option-btn" onclick="exportData('excel')">Excel Ù…Ø¹ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</button>
        </div>
    </div>

    <script>
        const ADMIN_CREDENTIALS = {
            username: "issaj",
            password: "730241&Oo"
        };

        function showNotification(message, duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            setTimeout(() => {
                notification.style.display = 'none';
            }, duration);
        }

        function showExportOptions() {
            const options = document.getElementById('exportOptions');
            options.style.display = options.style.display === 'none' ? 'flex' : 'none';
        }

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadDashboard();
            } else {
                alert('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©');
            }
        }

        let currentFilter = 'all';
        let allBookings = [];

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù…Ù† CSV Ø§Ù„Ù…Ø­Ø³Ù†
        function loadInitialData() {
            const initialData = [
                {
                    id: 1,
                    name: "Ø§Ø®ØªØ¨Ø§Ø±",
                    phone: "+966505055050",
                    email: "isskhsggtsg@gmail.com",
                    service: "cars",
                    budget: "ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
                    date: "2025-11-05",
                    duration: "3 Ø³Ø§Ø¹Ø§Øª",
                    location: "Ø§Ù„Ø±ÙŠØ§Ø¶",
                    status: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
                    paymentMethod: "Ù†Ù‚Ø¯ÙŠ",
                    notes: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª",
                    createdAt: "2025-09-22",
                    contacted: false,
                    serious: false
                },
                {
                    id: 2,
                    name: "Ø¹ÙŠØ³Ù‰",
                    phone: "+966539717602",
                    email: "issaljadali@gmail.com",
                    service: "cars",
                    budget: "500-1000",
                    date: "2025-11-13",
                    duration: "4 Ø³Ø§Ø¹Ø§Øª",
                    location: "Ø¬Ø¯Ø©",
                    status: "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
                    paymentMethod: "ØªØ­ÙˆÙŠÙ„",
                    notes: "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª",
                    createdAt: "2025-09-22",
                    contacted: false,
                    serious: false
                }
            ];
            
            // Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            if (!localStorage.getItem('issaBookings')) {
                localStorage.setItem('issaBookings', JSON.stringify(initialData));
            }
        }

        function loadDashboard() {
            loadInitialData();
            allBookings = JSON.parse(localStorage.getItem('issaBookings')) || [];
            updateStats();
            filterBookings(currentFilter);
        }

        function updateStats() {
            const total = allBookings.length;
            const pending = allBookings.filter(b => !b.contacted).length;
            const contacted = allBookings.filter(b => b.contacted).length;
            const serious = allBookings.filter(b => b.serious).length;

            document.getElementById('totalBookings').textContent = total;
            document.getElementById('pendingBookings').textContent = pending;
            document.getElementById('contactedBookings').textContent = contacted;
            document.getElementById('seriousClients').textContent = serious;
        }

        function filterBookings(filter) {
            currentFilter = filter;
            
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            let filteredBookings = allBookings;
            
            switch(filter) {
                case 'pending':
                    filteredBookings = allBookings.filter(b => !b.contacted);
                    break;
                case 'contacted':
                    filteredBookings = allBookings.filter(b => b.contacted);
                    break;
                case 'serious':
                    filteredBookings = allBookings.filter(b => b.serious);
                    break;
                case 'notSerious':
                    filteredBookings = allBookings.filter(b => !b.serious);
                    break;
            }

            displayBookings(filteredBookings);
        }

        function displayBookings(bookings) {
            const bookingsList = document.getElementById('bookingsList');
            bookingsList.innerHTML = bookings.map(booking => `
                <tr>
                    <td>${booking.id}</td>
                    <td>${booking.name}</td>
                    <td>${booking.phone}</td>
                    <td>${booking.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}</td>
                    <td>${getServiceName(booking.service)}</td>
                    <td>${booking.budget}</td>
                    <td>${booking.date}</td>
                    <td>${booking.duration || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td>${booking.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td class="status-${booking.contacted ? 'contacted' : 'pending'}">
                        ${booking.contacted ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}
                    </td>
                    <td>${booking.paymentMethod || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td>
                    <td>${booking.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}</td>
                    <td>
                        <button class="action-btn contacted-btn" onclick="toggleContacted(${booking.id})">
                            ${booking.contacted ? 'âœ“' : 'âœ‰ï¸'}
                        </button>
                        <button class="action-btn ${booking.serious ? 'not-serious-btn' : 'serious-btn'}" onclick="toggleSerious(${booking.id})">
                            ${booking.serious ? 'ØºÙŠØ± Ø¬Ø§Ø¯' : 'Ø¬Ø§Ø¯'}
                        </button>
                        <button class="action-btn delete-btn" onclick="deleteBooking(${booking.id})">ğŸ—‘ï¸</button>
                        <button class="action-btn" onclick="callClient('${booking.phone}')">ğŸ“</button>
                        <button class="action-btn" onclick="whatsappClient('${booking.phone}')">ğŸ’¬</button>
                    </td>
                </tr>
            `).join('');
        }

        function getServiceName(service) {
            const services = {
                'cars': 'ØªØµÙˆÙŠØ± Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª',
                'realestate': 'ØªØµÙˆÙŠØ± Ø§Ù„Ø¹Ù‚Ø§Ø±Ø§Øª',
                'events': 'ØªØµÙˆÙŠØ± Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª'
            };
            return services[service] || service;
        }

        function toggleContacted(bookingId) {
            const booking = allBookings.find(b => b.id === bookingId);
            if (booking) {
                booking.contacted = !booking.contacted;
                localStorage.setItem('issaBookings', JSON.stringify(allBookings));
                filterBookings(currentFilter);
                updateStats();
            }
        }

        function toggleSerious(bookingId) {
            const booking = allBookings.find(b => b.id === bookingId);
            if (booking) {
                booking.serious = !booking.serious;
                localStorage.setItem('issaBookings', JSON.stringify(allBookings));
                filterBookings(currentFilter);
                updateStats();
            }
        }

        function deleteBooking(bookingId) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø­Ø¬Ø²ØŸ')) {
                allBookings = allBookings.filter(b => b.id !== bookingId);
                localStorage.setItem('issaBookings', JSON.stringify(allBookings));
                filterBookings(currentFilter);
                updateStats();
            }
        }

        function callClient(phone) {
            window.open(`tel:${phone}`, '_self');
        }

        function whatsappClient(phone) {
            window.open(`https://wa.me/${phone}`, '_blank');
        }

        function exportData(format) {
            const bookings = JSON.parse(localStorage.getItem('issaBookings')) || [];
            
            // Ø¥Ø¶Ø§ÙØ© BOM Ù„Ø¶Ù…Ø§Ù† Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
            const BOM = "\uFEFF";
            
            let content, filename, instructions;
            
            if (format === 'txt') {
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… TAB ÙƒÙØ§ØµÙ„ (Ø£ÙƒØ«Ø± ØªÙˆØ§ÙÙ‚Ø§Ù‹)
                content = BOM + "Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²\tØ§Ù„Ø§Ø³Ù…\tØ§Ù„Ù‡Ø§ØªÙ\tØ§Ù„Ø¨Ø±ÙŠØ¯\tØ§Ù„Ø®Ø¯Ù…Ø©\tØ§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©\tØ§Ù„ØªØ§Ø±ÙŠØ®\tØ§Ù„Ù…Ø¯Ø©\tØ§Ù„Ù…ÙˆÙ‚Ø¹\tØ§Ù„Ø­Ø§Ù„Ø©\tØ·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹\tÙ…Ù„Ø§Ø­Ø¸Ø§Øª\tØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡\n";
                
                bookings.forEach(booking => {
                    const row = [
                        booking.id,
                        booking.name,
                        booking.phone,
                        booking.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯',
                        getServiceName(booking.service),
                        booking.budget || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                        booking.date,
                        booking.duration || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                        booking.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                        booking.contacted ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±',
                        booking.paymentMethod || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯',
                        booking.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª',
                        booking.createdAt
                    ].join('\t');
                    
                    content += row + '\n';
                });
                
                filename = 'Ø­Ø¬ÙˆØ²Ø§Øª-Ø§Ù„Ù…ØµÙˆØ±-Ø¹ÙŠØ³Ù‰.txt';
                instructions = "Ù„Ù„ÙØªØ­ ÙÙŠ Excel: Data â†’ From Text/CSV â†’ Ø§Ø®ØªØ± UTF-8 â†’ Delimiter: Tab";
                
            } else if (format === 'excel') {
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ø±Ø´Ø§Ø¯Ø§Øª ÙÙŠ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ù„Ù
                content = BOM + "Ø¥Ø±Ø´Ø§Ø¯Ø§Øª Ø§Ù„ÙØªØ­ ÙÙŠ Excel:\n";
                content += "1. Ø§ÙØªØ­ Excel Ø¬Ø¯ÙŠØ¯\n";
                content += "2. Ø§Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Data â†’ Get Data â†’ From File â†’ From Text/CSV\n";
                content += "3. Ø§Ø®ØªØ± Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù\n";
                content += "4. Encoding: Ø§Ø®ØªØ± UTF-8\n";
                content += "5. Delimiter: Ø§Ø®ØªØ± Comma\n";
                content += "6. Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Load\n\n";
                content += "Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²,Ø§Ù„Ø§Ø³Ù…,Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ø¨Ø±ÙŠØ¯,Ø§Ù„Ø®Ø¯Ù…Ø©,Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ù…Ø¯Ø©,Ø§Ù„Ù…ÙˆÙ‚Ø¹,Ø§Ù„Ø­Ø§Ù„Ø©,Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹,Ù…Ù„Ø§Ø­Ø¸Ø§Øª,ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡\n";
                
                bookings.forEach(booking => {
                    const row = [
                        booking.id,
                        `"${booking.name}"`,
                        `"${booking.phone}"`,
                        `"${booking.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}"`,
                        `"${getServiceName(booking.service)}"`,
                        `"${booking.budget || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.date}"`,
                        `"${booking.duration || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.contacted ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}"`,
                        `"${booking.paymentMethod || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}"`,
                        `"${booking.createdAt}"`
                    ].join(',');
                    
                    content += row + '\n';
                });
                
                filename = 'Ø­Ø¬ÙˆØ²Ø§Øª-Ø§Ù„Ù…ØµÙˆØ±-Ø¹ÙŠØ³Ù‰-Ù…Ø¹-Ø¥Ø±Ø´Ø§Ø¯Ø§Øª.csv';
                
            } else {
                // CSV Ø¹Ø§Ø¯ÙŠ
                content = BOM + "Ø±Ù‚Ù… Ø§Ù„Ø­Ø¬Ø²,Ø§Ù„Ø§Ø³Ù…,Ø§Ù„Ù‡Ø§ØªÙ,Ø§Ù„Ø¨Ø±ÙŠØ¯,Ø§Ù„Ø®Ø¯Ù…Ø©,Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©,Ø§Ù„ØªØ§Ø±ÙŠØ®,Ø§Ù„Ù…Ø¯Ø©,Ø§Ù„Ù…ÙˆÙ‚Ø¹,Ø§Ù„Ø­Ø§Ù„Ø©,Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹,Ù…Ù„Ø§Ø­Ø¸Ø§Øª,ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡\n";
                
                bookings.forEach(booking => {
                    const row = [
                        booking.id,
                        `"${booking.name}"`,
                        `"${booking.phone}"`,
                        `"${booking.email || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯'}"`,
                        `"${getServiceName(booking.service)}"`,
                        `"${booking.budget || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.date}"`,
                        `"${booking.duration || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.location || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.contacted ? 'ØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„' : 'Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±'}"`,
                        `"${booking.paymentMethod || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}"`,
                        `"${booking.notes || 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù„Ø§Ø­Ø¸Ø§Øª'}"`,
                        `"${booking.createdAt}"`
                    ].join(',');
                    
                    content += row + '\n';
                });
                
                filename = 'Ø­Ø¬ÙˆØ²Ø§Øª-Ø§Ù„Ù…ØµÙˆØ±-Ø¹ÙŠØ³Ù‰.csv';
                instructions = "Ù„Ù„ÙØªØ­ ÙÙŠ Excel: Data â†’ From Text/CSV â†’ Ø§Ø®ØªØ± UTF-8";
            }
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const link = document.createElement('a');
            
            if (window.navigator && window.navigator.msSaveOrOpenBlob) {
                // Ù„Ù€ Internet Explorer
                window.navigator.msSaveOrOpenBlob(blob, filename);
            } else {
                // Ù„Ù„Ù…ØªØµÙØ­Ø§Øª Ø§Ù„Ø­Ø¯ÙŠØ«Ø©
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', filename);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            }
            
            if (instructions) {
                showNotification('ØªÙ… Ø§Ù„ØªØµØ¯ÙŠØ±! ' + instructions, 5000);
            } else {
                showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!');
            }
            
            // Ø¥Ø®ÙØ§Ø¡ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„ØªØµØ¯ÙŠØ±
            document.getElementById('exportOptions').style.display = 'none';
        }

        document.addEventListener('DOMContentLoaded', function() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('dashboard').style.display = 'none';
        });
    </script>
</body>
</html>